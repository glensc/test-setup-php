name: runner workflow
on:
  push:
jobs:
  ubuntu:
    name: runner
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-latest, macos-latest]
    steps:
      - name: Test
        run: |
          latest_url="https://github.com/phpstan/phpstan/releases/latest/download/phpstan.phar"
          repo=$(echo "$latest_url" | cut -d '/' -f '1-5')
          file=$(echo "$latest_url" | sed -e "s/.*\///")
          asset_release=$(curl -sL "$repo/releases" | grep -Eo -m 1 "([0-9]+\.[0-9]+\.[0-9]+)/$file" | cut -d '/' -f 1)
          echo $latest_url | sed -e "s|releases/latest/download|releases/download/$asset_release}|"
