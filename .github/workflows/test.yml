name: 'Test'
on: [push]
jobs:
  tests:  
    strategy:
      fail-fast: false
      matrix:
        os: [windows-2016, windows-2019]
    runs-on: ${{ matrix.os }}
    steps:
      - run: netstat -anbo
      - name: Install apache2
        run: |
          choco install apache-httpd --params "/installLocation:C:\tools /port:80" -y --force
          Stop-Service -Name Apache                
      - name: Install nginx
        run: |
          choco install nginx --params "/installLocation:C:\tools /port:80" -y --force
          Stop-Service -Name nginx
      - name: Test setup
        run: |
          Get-ChildItem C:\tools
          foreach ($server in ("Apache", "nginx")) {
            Start-Service -Name $server
            Get-Service -Name $server
            Stop-Service -Name $server
          }
