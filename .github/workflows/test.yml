name: Container setup
on:
  repository_dispatch:
  push:
jobs:
  ubuntu:
    name: ubuntu
    runs-on: ubuntu-latest
    container: ubuntu:${{ matrix.containers }}
    strategy:
      fail-fast: false
      matrix:
        containers: ["focal", "bionic", "xenial"]
        php-versions: ['5.6', '7.0', '7.1', '7.2', '7.3', '7.4']
    steps:
      - name: Install requirements
        env:
          version: ${{ matrix.php-versions }}
        run: |
          DEBIAN_FRONTEND=noninteractive apt-get update
          DEBIAN_FRONTEND=noninteractive apt-get install -y sudo curl make software-properties-common unzip
          sudo LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php
          sudo DEBIAN_FRONTEND=noninteractive apt-get update
          sudo DEBIAN_FRONTEND=noninteractive apt-get install -y php$version php$version-xml php$version-dev php-pear        
      - run: php -v && php -m
      - run: sudo pecl install -f xdebug
